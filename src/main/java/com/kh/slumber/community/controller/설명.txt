컨트롤러입니다. 큰 특이점은 없습니다만, 코드 중복을 막기 위해 많은 수정을 했습니다.